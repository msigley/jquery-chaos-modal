/*
 * jQuery Chaos Modal
 * By Matthew Sigley
 * Based on concept work by Kevin Liew - http://www.queness.com/post/77/simple-jquery-modal-window-tutorial
 * Version 1.5.0
 */
(function(a){function h(){var a="undefined"!==typeof navigator?navigator.userAgent:"";return/msie|trident/i.test(a)?(a=a.match(/(?:msie |rv:)(\d+(\.\d+)?)/i))&&1<a.length&&a[1]||"":/chrome.+? edge/i.test(a)?(a=a.match(/edge\/(\d+(\.\d+)?)/i))&&1<a.length&&a[1]||"":""}function p(d){var e=!1;d.data.alwaysAtTop&&(e=d.data.alwaysAtTop);a.chaosModalCurrent.resizeModal(e)}function f(d){d.preventDefault();if(500>Date.now()-a.openTime)return!1;a(document).off(".chaosmodal");null!=a.chaosModalCurrent?a.chaosModalCurrent.closeModal():
(a(window).trigger("chaos-modal-preprocess-interrupt"),a("#chaos-modal-mask").hide().remove(),a.fn.closeLoading());a.modalMask=null}function c(d){d.preventDefault();a.chaosModalCurrent.printModal()}function q(a){27==a.which&&f(a)}function k(){var d=a(document),e=a(window),b=a("html"),d=d.height(),b=b.width(),c=e.height(),e=e.width();a("#chaos-modal-mask").css({width:b,height:d});posx=e/2-parseInt(a("#modal-loading").css("width"))/2;posy=c/2-parseInt(a("#modal-loading").css("height"))/2;a.chaosModalLoading=
a("#modal-loading");a.chaosModalLoading.css("top",posy);a.chaosModalLoading.css("left",posx)}a(window);var n="",n=bowser.msie?bowser.version:bowser.msedge?bowser.version:h(),m=function(a){if(null===a.offsetParent)return!1;if(11>n){var e="";"undefined"!=typeof getComputedStyle?e=window.getComputedStyle(a).display:"undefined"!=typeof a.currentStyle&&(e=a.currentStyle.display);if("none"==e||"fixed"==e||"absolute"==e)return!1}return!0};a.chaosModalLoading=null;a.modalMask=null;a.chaosModalCurrent=null;
a.chaosModalMaxWidth=0;a.chaosModalIndex=0;a.chaosModalImagesLoaded=!1;a.chaosModalIframesLoaded=!1;a.fn.openModal=function(d){function e(){var b=a(this),d=b.data("src");d&&b.attr("src",d).attr("data-src","")}if(null==a.chaosModalCurrent){d=a.extend({},{maxWidth:960,closeLink:!0,printLink:!1,alwaysAtTop:!1,preprocessing:!1},d);this.find('iframe[src=""]').each(e);var b=this.clone(!0),l=a("body");a("html");a(document);var g=a(window),k=d.closeLink,q=d.printLink,h=d.alwaysAtTop;a.chaosModalMaxWidth=
d.maxWidth;a.chaosModalCurrent=b;b.attr({id:"chaos-current-modal"});0==b.find(".print-link").length&&q&&(b.prepend('<a class="print-link">Print</a>'),b.children(".print-link").css({"float":"right",margin:"5px"}));0==b.find(".close-link").length&&k&&(b.prepend('<a class="close-link">Close</a>'),b.children(".close-link").css({"float":"right",margin:"5px"}));b.css({display:"block",position:"absolute",background:"#fff","z-index":"9002",left:"-10000px",margin:"0",padding:"0"});b.prependTo(l);var r=function(){b.width()>
a.chaosModalMaxWidth?b.width(a.chaosModalMaxWidth):b.width(b.width());b.find("img").css("max-width","100%");b.hide();b.resizeModal(h);a.modalMask.stop();b.fadeIn(2E3,function(){b.resizeModal(h);g.bind("resize",{alwaysAtTop:h},p);a.fn.closeLoading()});0<b.find(".print-link").length&&b.find(".print-link").bind("click",c);0<b.find(".close-link").length&&b.find(".close-link").bind("click",f)};d=b.find("img").filter(function(a,b){return!m(b)||b.complete||"undefined"==typeof b.naturalWidth||0!=b.naturalWidth?
!1:!0});l=b.find("iframe").filter(function(a,b){return n||!m(b)||"complete"==(b.contentDocument||b.contentWindow.document).readyState?!1:!0});a.imagesToLoad=d.length;a.iframesToLoad=l.length;a.imagesToLoad||a.iframesToLoad?(d.on("load",function(){--a.imagesToLoad;a.imagesToLoad||a.iframesToLoad||r()}),l.on("load",function(){--a.iframesToLoad;a.imagesToLoad||a.iframesToLoad||r()})):r();b.show();return this}};a.fn.closeModal=function(){a(window).unbind("resize",p);a.chaosModalCurrent=null;0<this.find(".close-link").length&&
this.find(".close-link").unbind("click");this.hide().remove();a("#chaos-modal-mask").hide().remove();a.fn.closeLoading();return this};a.fn.resizeModal=function(d){var e=a(document),b=a(window),c=a("html"),g=e.height(),f=c.width(),k=b.height(),c=b.width();g<this.height()&&(g=this.height());f<c&&(f=c);a("#chaos-modal-mask").css({width:f,height:g});g=k/2-this.height()/2;c=c/2-this.width()/2;0>g&&(g=0);0>c&&(c=0);d?b.scrollTop(0):(g+=b.scrollTop(),d=e.height()-(g+this.height()),0>d&&0<=g+d&&(g+=d));b.scrollLeft(0);
this.css({top:g,left:c});return this};a.fn.printModal=function(){window.print()};a.fn.showLoading=function(){a.openTime=Date.now();if(null==a.modalMask){var d=a("body"),c=a(window),b=c.height(),l=c.width();maskClose=!0;a.modalMask=a('<div id="chaos-modal-mask" class="chaos-modal-mask"></div>');a.modalMask.css({position:"absolute","z-index":"9000","background-color":"#000",display:"none",top:"0",left:"0"});a.modalMask.prependTo(d);a.modalMask.fadeIn(500);a.modalMask.fadeTo("fast",.8);var d=a(document),
c=a(window),g=a("html"),h=d.height(),g=g.width();maskClose&&(a.modalMask.on("click",f),d.on("keyup.chaosmodal",q));h<this.height()&&(h=this.height());g<l&&(g=l);a("#chaos-modal-mask").css({width:g,height:h});a("body").append('<div id="modal-loading" style="position: fixed; z-index: 9001; color: #fff;">Loading</div>');posx=l/2-parseInt(a("#modal-loading").css("width"))/2;posy=b/2-parseInt(a("#modal-loading").css("height"))/2;a.chaosModalLoading=a("#modal-loading");a.chaosModalLoading.css("top",posy);
a.chaosModalLoading.css("left",posx);c.bind("resize",{alwaysAtTop:!0},k)}};a.fn.closeLoading=function(){a.chaosModalLoading.remove()}})(jQuery);
jQuery(document).ready(function(a){function h(){var f=a(this),c=f.attr("src");f.attr("data-src",c).attr("src","")}function p(f){var c=a(this);f.preventDefault();c.off("click",p);var h=c.data("chaos-modal-box-id"),k=f=!1,n=/\.(jpeg|jpg|gif|png|bmp|wbmp)$/i,m=!1;f=h?a("#"+h).first():c.parent().find(".chaos-modal-box").first();f.length?(k=a("<div></div>").css({padding:"20px"}),f.clone(!0).css({display:"block"}).appendTo(k),k=a("<div></div>").css({background:"#fff"}).append(k)):(n.test(c.attr("href"))?
m=c.attr("href"):(h=c.find("img"),1==h.length&&n.test(h.attr("src"))&&(m=h.attr("src"))),m&&(testRequest=a.ajax(m,{type:"HEAD",async:!1}),200==testRequest.status&&(k=a("<div></div>").css({padding:"20px"}),a('<img src="'+m+'" />').css({display:"block"}).appendTo(k),k=a("<div></div>").css({background:"#fff"}).append(k))));k&&(f.remove(),c.attr({href:"#",id:"chaos-modal-link-"+a.chaosModalIndex}),k.attr({id:"chaos-modal-box-"+a.chaosModalIndex}),k.hide(),k.appendTo("body"),c.click(function(){a.fn.showLoading();
var d={maxWidth:960,closeLink:!0,printLink:!1,alwaysAtTop:!1,preprocessing:!1};a.each(d,function(a,e){"undefined"!==typeof c.data("chaosmodal-"+a)&&(console.log(typeof c.data("chaosmodal-"+a)),d[a]="maxWidth"==a?parseInt(c.data("chaosmodal-"+a)):"true"==c.data("chaosmodal-"+a))});preprocess=c.attr("data-preprocess");var e=a(this).attr("id").match(/chaos-modal-link-(\d+)/i);e[1]&&(e=a("#chaos-modal-box-"+e[1]),1==e.length&&"true"!=preprocess?e.openModal(d):1==e.length&&"true"==preprocess&&c.trigger("chaos-modal-preprocess",
e));return!1}),c.click(),a.chaosModalIndex++);return!1}a(".chaos-modal-link").not("a").each(function(){var f=a(this),c=f.children();f.removeClass("chaos-modal-link");c.not("a").length||1==c.length&&c.addClass("chaos-modal-link")});a("a.chaos-modal-link").on("click",p);a(".chaos-modal-box:hidden iframe").each(h);a(".chaos-modal-link").each(function(){var f=a(this).data("chaos-modal-box-id");f&&a("#"+f+":hidden iframe").each(h)});Date.now||(Date.now=function(){return(new Date).getTime()})});