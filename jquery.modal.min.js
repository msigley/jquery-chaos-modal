/*
 * jQuery Chaos Modal
 * By Matthew Sigley
 * Based on concept work by Kevin Liew - http://www.queness.com/post/77/simple-jquery-modal-window-tutorial
 * Version 1.4
 */
(function(a){function l(){var a="undefined"!==typeof navigator?navigator.userAgent:"";return/msie|trident/i.test(a)?(a=a.match(/(?:msie |rv:)(\d+(\.\d+)?)/i))&&1<a.length&&a[1]||"":""}function p(b){var e=!1;b.data.alwaysAtTop&&(e=b.data.alwaysAtTop);a.chaosModalCurrent.resizeModal(e)}function f(b){b.preventDefault();if(500>Date.now()-a.openTime)return!1;a(document).off(".chaosmodal");null!=a.chaosModalCurrent?a.chaosModalCurrent.closeModal():(a(window).trigger("chaos-modal-preprocess-interrupt"),
a("#chaos-modal-mask").hide().remove(),a.fn.closeLoading());a.modalMask=null}function d(b){b.preventDefault();a.chaosModalCurrent.printModal()}function n(a){27==a.which&&f(a)}function h(){var b=a(document),e=a(window),c=a("html"),b=b.height(),c=c.width(),k=e.height(),e=e.width();a("#chaos-modal-mask").css({width:c,height:b});posx=e/2-parseInt(a("#modal-loading").css("width"))/2;posy=k/2-parseInt(a("#modal-loading").css("height"))/2;a.chaosModalLoading=a("#modal-loading");a.chaosModalLoading.css("top",
posy);a.chaosModalLoading.css("left",posx)}a(window);var m="",m=bowser.msie?bowser.version:l(),q=function(a){if(null===a.offsetParent)return!1;if(11>m){var e="";"undefined"!=typeof getComputedStyle?e=window.getComputedStyle(a).display:"undefined"!=typeof a.currentStyle&&(e=a.currentStyle.display);if("none"==e||"fixed"==e||"absolute"==e)return!1}return!0};a.chaosModalLoading=null;a.modalMask=null;a.chaosModalCurrent=null;a.chaosModalMaxWidth=0;a.chaosModalIndex=0;a.chaosModalImagesLoaded=!1;a.chaosModalIframesLoaded=
!1;a.fn.openModal=function(b){function e(){var b=a(this),c=b.data("src");c&&b.attr("src",c).attr("data-src","")}if(null==a.chaosModalCurrent){b=a.extend({},{maxWidth:960,closeLink:!0,printLink:!1,alwaysAtTop:!1,preprocessing:!1},b);this.find('iframe[src=""]').each(e);var c=this.clone(!0),k=a("body");a("html");a(document);var g=a(window),h=b.closeLink,n=b.printLink,m=b.alwaysAtTop;a.chaosModalMaxWidth=b.maxWidth;a.chaosModalCurrent=c;c.attr({id:"chaos-current-modal"});0==c.find(".print-link").length&&
n&&(c.prepend('<a class="print-link">Print</a>'),c.children(".print-link").css({"float":"right",margin:"5px"}));0==c.find(".close-link").length&&h&&(c.prepend('<a class="close-link">Close</a>'),c.children(".close-link").css({"float":"right",margin:"5px"}));c.css({display:"block",position:"absolute",background:"#fff","z-index":"9002",left:"-10000px",margin:"0",padding:"0"});c.prependTo(k);var l=function(){c.width()>a.chaosModalMaxWidth?c.width(a.chaosModalMaxWidth):c.width(c.width());c.find("img").css("max-width",
"100%");c.hide();c.resizeModal(m);a.modalMask.stop();c.fadeIn(2E3,function(){c.resizeModal(m);g.bind("resize",{alwaysAtTop:m},p);a.fn.closeLoading()});0<c.find(".print-link").length&&c.find(".print-link").bind("click",d);0<c.find(".close-link").length&&c.find(".close-link").bind("click",f)};b=c.find("img").filter(function(a,b){return!q(b)||b.complete||"undefined"==typeof b.naturalWidth||0!=b.naturalWidth?!1:!0});k=c.find("iframe").filter(function(a,b){return q(b)&&"complete"!=b.contentDocument.readyState?
!0:!1});a.imagesToLoad=b.length;a.iframesToLoad=k.length;a.imagesToLoad||a.iframesToLoad?(b.on("load",function(){--a.imagesToLoad;a.imagesToLoad||a.iframesToLoad||l()}),k.on("load",function(){--a.iframesToLoad;a.imagesToLoad||a.iframesToLoad||l()})):l();c.show();return this}};a.fn.closeModal=function(){a(window).unbind("resize",p);a.chaosModalCurrent=null;0<this.find(".close-link").length&&this.find(".close-link").unbind("click");this.hide().remove();a("#chaos-modal-mask").hide().remove();a.fn.closeLoading();
return this};a.fn.resizeModal=function(b){var e=a(document),c=a(window),k=a("html"),g=e.height(),f=k.width(),d=c.height(),k=c.width();g<this.height()&&(g=this.height());f<k&&(f=k);a("#chaos-modal-mask").css({width:f,height:g});g=d/2-this.height()/2;k=k/2-this.width()/2;0>g&&(g=0);0>k&&(k=0);b?c.scrollTop(0):(g+=c.scrollTop(),b=e.height()-(g+this.height()),0>b&&0<=g+b&&(g+=b));c.scrollLeft(0);this.css({top:g,left:k});return this};a.fn.printModal=function(){window.print()};a.fn.showLoading=function(){a.openTime=
Date.now();if(null==a.modalMask){var b=a("body"),e=a(window),c=e.height(),d=e.width();maskClose=!0;a.modalMask=a('<div id="chaos-modal-mask" class="chaos-modal-mask"></div>');a.modalMask.css({position:"absolute","z-index":"9000","background-color":"#000",display:"none",top:"0",left:"0"});a.modalMask.prependTo(b);a.modalMask.fadeIn(500);a.modalMask.fadeTo("fast",.8);var b=a(document),e=a(window),g=a("html"),m=b.height(),g=g.width();maskClose&&(a.modalMask.on("click",f),b.on("keyup.chaosmodal",n));
m<this.height()&&(m=this.height());g<d&&(g=d);a("#chaos-modal-mask").css({width:g,height:m});a("body").append('<div id="modal-loading" style="position: fixed; z-index: 9001; color: #fff;">Loading</div>');posx=d/2-parseInt(a("#modal-loading").css("width"))/2;posy=c/2-parseInt(a("#modal-loading").css("height"))/2;a.chaosModalLoading=a("#modal-loading");a.chaosModalLoading.css("top",posy);a.chaosModalLoading.css("left",posx);e.bind("resize",{alwaysAtTop:!0},h)}};a.fn.closeLoading=function(){a.chaosModalLoading.remove()}})(jQuery);
jQuery(document).ready(function(a){function l(){var f=a(this),d=f.attr("src");f.attr("data-src",d).attr("src","")}function p(f){var d=a(this);f.preventDefault();d.off("click",p);var n=d.data("chaos-modal-box-id"),h=f=!1,m=/\.(jpeg|jpg|gif|png|bmp|wbmp)$/i,l=!1;f=n?a("#"+n).first():d.parent().find(".chaos-modal-box").first();f.length?(h=a("<div></div>").css({padding:"20px"}),f.clone(!0).css({display:"block"}).appendTo(h),h=a("<div></div>").css({background:"#fff"}).append(h)):(m.test(d.attr("href"))?
l=d.attr("href"):(n=d.find("img"),1==n.length&&m.test(n.attr("src"))&&(l=n.attr("src"))),l&&(testRequest=a.ajax(l,{type:"HEAD",async:!1}),200==testRequest.status&&(h=a("<div></div>").css({padding:"20px"}),a('<img src="'+l+'" />').css({display:"block"}).appendTo(h),h=a("<div></div>").css({background:"#fff"}).append(h))));h&&(f.remove(),d.attr({href:"#",id:"chaos-modal-link-"+a.chaosModalIndex}),h.attr({id:"chaos-modal-box-"+a.chaosModalIndex}),h.hide(),h.appendTo("body"),d.click(function(){a.fn.showLoading();
preprocess=d.attr("data-preprocess");var b=a(this).attr("id").match(/chaos-modal-link-(\d+)/i);b[1]&&(b=a("#chaos-modal-box-"+b[1]),1==b.length&&"true"!=preprocess?b.openModal():1==b.length&&"true"==preprocess&&d.trigger("chaos-modal-preprocess",b));return!1}),d.click(),a.chaosModalIndex++);return!1}a(".chaos-modal-link").not("a").each(function(){var f=a(this),d=f.children();f.removeClass("chaos-modal-link");d.not("a").length||1==d.length&&d.addClass("chaos-modal-link")});a("a.chaos-modal-link").on("click",
p);a(".chaos-modal-box:hidden iframe").each(l);a(".chaos-modal-link").each(function(){var f=a(this).data("chaos-modal-box-id");f&&a("#"+f+":hidden iframe").each(l)});Date.now||(Date.now=function(){return(new Date).getTime()})});