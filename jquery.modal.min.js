/*
 * jQuery Chaos Modal
 * By Matthew Sigley
 * Based on concept work by Kevin Liew - http://www.queness.com/post/77/simple-jquery-modal-window-tutorial
 * Version 1.10.1
 */
(function(a){function m(c){clearTimeout(a.chaosModalResizeTimer);if(a.chaosModalCurrent){var b=!1;c.data.alwaysAtTop&&(b=c.data.alwaysAtTop);a.chaosModalResizeTimer=setTimeout(f,16,b);a.chaosModalCurrent.resizeModal(b)}}function f(c){clearTimeout(a.chaosModalResizeTimer);a.chaosModalCurrent.resizeModal(c)}function h(c){c.preventDefault();if(500>Date.now()-a.openTime)return!1;clearTimeout(a.chaosModalClickTimer);a(document).off(".chaosmodal");null!=a.chaosModalCurrent?a.chaosModalCurrent.closeModal():
(a(window).trigger("chaos-modal-preprocess-interrupt"),a("#chaos-modal-mask").hide().remove(),a.fn.closeLoading());a.modalMask=null}function r(c){c.preventDefault();a.chaosModalCurrent.printModal()}function t(a){27==a.which&&h(a)}function u(){var c=a(document),b=a(window),e=a("html");c=c.height();e=e.width();var d=b.height();b=b.width();a("#chaos-modal-mask").css({width:e,height:c});posx=b/2-parseInt(a("#modal-loading").css("width"))/2;posy=d/2-parseInt(a("#modal-loading").css("height"))/2;a.chaosModalLoading=
a("#modal-loading");a.chaosModalLoading.css("top",posy);a.chaosModalLoading.css("left",posx)}var v=function(){var a="undefined"!==typeof navigator?navigator.userAgent:"";return/msie|trident/i.test(a)?(a=a.match(/(?:msie |rv:)(\d+(\.\d+)?)/i))&&1<a.length&&a[1]||"":/chrome.+? edge/i.test(a)?(a=a.match(/edge\/(\d+(\.\d+)?)/i))&&1<a.length&&a[1]||"":""};a(window);var p="";p=bowser.msie?bowser.version:bowser.msedge?bowser.version:v();a.chaosModalExitFullscreen=function(){"fullscreenEnabled"in document?
document.exitFullscreen():"webkitFullscreenEnabled"in document?document.webkitExitFullscreen():"mozFullScreenEnabled"in document?document.mozCancelFullScreen():"msExitFullscreen"in document&&document.msExitFullscreen()};a.chaosModalIsVisible=function(a){if(null===a.offsetParent)return!1;if(11>p){var b="";"undefined"!=typeof getComputedStyle?b=window.getComputedStyle(a).display:"undefined"!=typeof a.currentStyle&&(b=a.currentStyle.display);if("none"==b||"fixed"==b||"absolute"==b)return!1}return!0};
a.chaosModalLoading=null;a.modalMask=null;a.chaosModalCurrent=null;a.chaosModalMaxWidth=0;a.chaosModalIndex=0;a.chaosModalImagesLoaded=!1;a.chaosModalIframesLoaded=!1;a.chaosModalClickTimer=!1;a.chaosModalResizeTimer=null;a.chaosModalPrintCSSElements=null;a.fn.openModal=function(c){a.chaosModalExitFullscreen();if(null==a.chaosModalCurrent){var b=this.clone(!0),e=a("body");a("html");a(document);var d=a(window),g=c.closeLink,l=c.printLink,q=c.alwaysAtTop;a.chaosModalMaxWidth=c.maxWidth;a.chaosModalCurrent=
b;var n=b.html();b.attr({id:"chaos-current-modal"});0==b.find(".print-link").length&&l&&(b.prepend('<a class="print-link">Print</a>'),b.children(".print-link").css({"float":"right",margin:"5px"}));0==b.find(".close-link").length&&g&&(b.prepend('<a class="close-link">Close</a>'),b.children(".close-link").css({"float":"right",margin:"5px"}));b.css({display:"block",position:"absolute",background:"#fff","z-index":"9002",left:"-10000px",margin:"0",padding:"0"});g=b.find('iframe[src=""]');1<g.length&&(c.iframeAddAutoplay=
!1);g.each(function(){var b=a(this),d=b.data("src");if(d){if(c.iframeAddAutoplay){var e=d.indexOf("?");-1==e?d+="?":e!=d.length-1&&(d+="&amp;");d+="autoplay=1";b.attr("allow","autoplay")}b.attr("src",d).attr("data-src","")}});b.prependTo(e);if(l){a.chaosModalPrintCSSElements||(a.chaosModalPrintCSSElements=a(document.head).find('link[rel="stylesheet"]'));e=a('<iframe class="print-iframe" width="100" height="100" style="position: absolute; left: -20000px; top: 0;"></iframe>');b.append(e);var k=e.get(0).contentDocument;
k.open();k.write("<!DOCTYPE html>");k.write("<html><head>");a.chaosModalPrintCSSElements.each(function(){k.write(this.outerHTML)});k.write("</head><body>");k.write(n);k.write("</body></html>");k.close()}var f=function(){b.width()>a.chaosModalMaxWidth?b.width(a.chaosModalMaxWidth):b.width(b.width());b.css("max-width","92%");b.find("img").css("max-width","100%");b.hide();b.resizeModal(q);0<b.find(".print-link").length&&b.find(".print-link").bind("click",r);0<b.find(".close-link").length&&b.find(".close-link").bind("click",
h);c.clickPassthrough&&b.find(".fallback-link").bind("click",function(){clearTimeout(a.chaosModalClickTimer)});a.modalMask.stop();b.show(0,function(){b.resizeModal(q);d.bind("resize",{alwaysAtTop:q},m);a.fn.closeLoading();c.clickPassthrough&&(a.chaosModalClickTimer=setTimeout(function(){clearTimeout(a.chaosModalClickTimer);!window.open(c.clickPassthrough,c.clickTarget)&&confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=c.clickPassthrough)},
3E3))})};n=b.find("img").filter(function(b,c){return!a.chaosModalIsVisible(c)||c.complete&&""!=c.getAttribute("src")&&("undefined"==typeof c.naturalWidth||0!=c.naturalWidth)?!1:!0});e=b.find("iframe").filter(function(b,c){return p||!a.chaosModalIsVisible(c)||"complete"==(c.contentDocument||c.contentWindow.document).readyState?!1:!0});a.imagesToLoad=n.length;a.iframesToLoad=e.length;a.imagesToLoad||a.iframesToLoad?(n.on("load",function(){--a.imagesToLoad;a.imagesToLoad||a.iframesToLoad||f()}),e.on("load",
function(){--a.iframesToLoad;a.imagesToLoad||a.iframesToLoad||f()})):f();b.show();return this}};a.fn.closeModal=function(){clearTimeout(a.chaosModalResizeTimer);a(window).unbind("resize",m);a.chaosModalCurrent=null;0<this.find(".close-link").length&&this.find(".close-link").unbind("click");this.hide().remove();a("#chaos-modal-mask").hide().remove();a.fn.closeLoading();return this};a.fn.resizeModal=function(c){var b=a(document),e=a(window),d=a("html"),g=b.height(),l=d.width(),f=e.height();d=e.width();
a.isFunction(this.resizeIframes)&&this.resizeIframes();g<this.height()&&(g=this.height());l<d&&(l=d);a("#chaos-modal-mask").css({width:l,height:g});g=f/2-this.height()/2;d=d/2-this.width()/2;0>g&&(g=0);0>d&&(d=0);c?e.scrollTop(0):(g+=e.scrollTop(),c=b.height()-(g+this.height()),0>c&&0<=g+c&&(g+=c));e.scrollLeft(0);this.css({top:g,left:d});return this};a.fn.printModal=function(){var a=this.find(".print-iframe").get(0).contentWindow;a.focus();a.print()};a.fn.showLoading=function(){a.openTime=Date.now();
if(null==a.modalMask){var c=a("body"),b=a(window),e=b.height(),d=b.width();maskClose=!0;a.modalMask=a('<div id="chaos-modal-mask" class="chaos-modal-mask"></div>');a.modalMask.css({position:"absolute","z-index":"9000","background-color":"rgba(0, 0, 0, 0.8)",display:"none",top:"0",left:"0"});a.modalMask.prependTo(c);a.modalMask.show(0);c=a(document);b=a(window);var g=a("html"),f=c.height();g=g.width();maskClose&&(a.modalMask.on("click",h),c.on("keyup.chaosmodal",t));f<this.height()&&(f=this.height());
g<d&&(g=d);a("#chaos-modal-mask").css({width:g,height:f});a("body").append('<div id="modal-loading" style="position: fixed; z-index: 9001; color: #fff;">Loading</div>');posx=d/2-parseInt(a("#modal-loading").css("width"))/2;posy=e/2-parseInt(a("#modal-loading").css("height"))/2;a.chaosModalLoading=a("#modal-loading");a.chaosModalLoading.css("top",posy);a.chaosModalLoading.css("left",posx);b.bind("resize",{alwaysAtTop:!0},u)}};a.fn.closeLoading=function(){a.chaosModalLoading.remove()};a.processModalLink=
function(c){var b=a(this);c.preventDefault();b.off("click",a.processModalLink);var e=b.data("chaos-modal-box-id"),d=c=!1,g=/\.(jpeg|jpg|gif|png|bmp|wbmp)$/i,f=!1,h=!1;c=e?a("#"+e).first():b.parent().find(".chaos-modal-box").first();c.length?(d=a("<div></div>").css({padding:"20px"}),c.clone(!0).css({display:"block"}).appendTo(d),d=a("<div></div>").css({background:"#fff"}).append(d)):(g.test(b.attr("href"))?(f=b.attr("href"),h=b.attr("title")):(e=b.find("img"),1==e.length&&g.test(e.attr("src"))&&(f=
e.attr("src"),h=e.attr("title"))),f&&(d=a("<div></div>").css({padding:"20px"}),a('<img src="'+f+'" />').css({display:"block"}).appendTo(d),d=a("<div></div>").css({background:"#fff"}).append(d)),h&&(h=(h+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2")));d&&(c.remove(),b.data("chaos-modal-href",b.attr("href")),b.data("chaos-modal-target",b.attr("target")),b.attr({href:"#",target:null,id:"chaos-modal-link-"+a.chaosModalIndex}),d.attr({id:"chaos-modal-box-"+a.chaosModalIndex}),d.hide(),d.appendTo("body"),
b.click(function(){a.fn.showLoading();var c={maxWidth:960,closeLink:!0,printLink:!1,alwaysAtTop:!1,preprocessing:!1,clickPassthrough:!1,iframeAddAutoplay:!0,caption:h};a.each(c,function(a,e){var d=b.data("chaos-modal-"+a);"undefined"!==typeof d&&(c[a]="maxWidth"==a?parseInt(d):d)});if(c.caption){var e=a("<div>"+c.caption+"</div>").css({display:"table-caption","caption-side":"bottom","padding-top":0,"padding-right":"20px","padding-bottom":"20px","padding-left":"20px"});d.children().first().css("display",
"table").append(e);console.log(d.clone())}c.clickPassthrough&&(c.clickPassthrough=b.data("chaos-modal-href"),c.clickTarget=b.data("chaos-modal-target"),c.clickTarget||(c.clickTarget="_self"));preprocess=b.attr("data-preprocess");e=a(this).attr("id").match(/chaos-modal-link-(\d+)/i);e[1]&&(e=a("#chaos-modal-box-"+e[1]),1==e.length&&"true"!=preprocess?e.openModal(c):1==e.length&&"true"==preprocess&&b.trigger("chaos-modal-preprocess",[e,c]));return!1}),b.click(),a.chaosModalIndex++);return!1}})(jQuery);
jQuery(document).ready(function(a){function m(){var f=a(this),h=f.attr("src");h&&f.attr("data-src",h).attr("src","")}a(".chaos-modal-link").not("a").each(function(){var f=a(this),h=f.children();f.removeClass("chaos-modal-link");h.not("a").length||1==h.length&&h.addClass("chaos-modal-link")});a("a.chaos-modal-link").on("click",a.processModalLink);a(".chaos-modal-box:hidden iframe").each(m);a(".chaos-modal-link").each(function(){var f=a(this).data("chaos-modal-box-id");f&&a("#"+f+":hidden iframe").each(m)});
Date.now||(Date.now=function(){return(new Date).getTime()})});
